<!DOCTYPE HTML>
<!DOCTYPE html PUBLIC "" ""><HTML lang="en-US" xmlns="http://www.w3.org/TR/xhtml1/strict"><HEAD><META 
content="IE=11.0000" http-equiv="X-UA-Compatible">
<TITLE>Threat Modeling Report</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<META http-equiv="X-UA-Compatible" content="IE=edge">
<STYLE type="text/css">
          body {
          font-family: "Segoe UI Light", "Helvetica", "sans-serif";
          }

          img {
          padding:1px;
          border:1px solid #021a40;
          background-color:#ff0;
          }

          table {
          border-width: 0px;
          border-colapse: separate;
          border-spacing: 3px;
          }

          table.bordered {
          border: 1px solid;
          border-collapse: collapse;
          }
          table.bordered td, table.bordered th {
          border: 1px solid;
          padding-left: 0.2em;
          padding-right: 0.2em;
          }

          td{
          text-align: left;
          vertical-align: top;
          }

          .infotd {
          white-space: pre-wrap;
          }

          div.threat:nth-child(odd){
          background: rgba(100,100,100,0.1);
          }

          div.threat:nth-child(even){
          background: rgba(200,200,200,0.1);
          }

          h4 span{
          padding-right: 1em;
          }

        </STYLE>

<META name="GENERATOR" content="MSHTML 11.00.10570.1001"></HEAD>
<BODY>
<H1 tabindex="0" class="title">Threat Modeling Report</H1><SPAN tabindex="0">    
      Created on 11/7/2017 9:11:45 PM</SPAN>
<P tabindex="0"><STRONG>Threat Model Name: </STRONG></P>
<P tabindex="0"><STRONG>Owner: </STRONG></P>
<P tabindex="0"><STRONG>Reviewer: </STRONG></P>
<P tabindex="0"><STRONG>Contributors: </STRONG></P>
<P tabindex="0"><STRONG>Description: </STRONG></P>
<P tabindex="0"><STRONG>Assumptions: </STRONG></P>
<P tabindex="0"><STRONG>External Dependencies: </STRONG></P><BR>
<H3 tabindex="0">Threat Model Summary:</H3>
<TABLE>
  <TBODY>
  <TR tabindex="0" role="row">
    <TD>Not Started</TD>
    <TD>73</TD></TR>
  <TR tabindex="0" role="row">
    <TD>Not Applicable</TD>
    <TD>0</TD></TR>
  <TR tabindex="0" role="row">
    <TD>Needs Investigation</TD>
    <TD>0</TD></TR>
  <TR tabindex="0" role="row">
    <TD>Mitigation Implemented</TD>
    <TD>0</TD></TR>
  <TR tabindex="0" role="row">
    <TD>Total</TD>
    <TD>73</TD></TR>
  <TR tabindex="0" role="row">
    <TD>Total Migrated</TD>
    <TD>0</TD></TR></TBODY></TABLE>
<P class="bugtrack">
<HR>

<H2 tabindex="0">            Diagram: Keycloak Threat Modeling</H2><IMG 
tabindex="0" alt="Keycloak Threat Modeling diagram screenshot&#10;            " 
src="">
<H3 tabindex="0">Keycloak Threat Modeling Diagram Summary:           </H3>
<TABLE>
  <TBODY>
  <TR tabindex="0" role="row">
    <TD>Not Started</TD>
    <TD>73</TD></TR>
  <TR tabindex="0" role="row">
    <TD>Not Applicable</TD>
    <TD>0</TD></TR>
  <TR tabindex="0" role="row">
    <TD>Needs Investigation</TD>
    <TD>0</TD></TR>
  <TR tabindex="0" role="row">
    <TD>Mitigation Implemented</TD>
    <TD>0</TD></TR>
  <TR tabindex="0" role="row">
    <TD>Total</TD>
    <TD>73</TD></TR>
  <TR tabindex="0" role="row">
    <TD>Total Migrated</TD>
    <TD>0</TD></TR></TBODY></TABLE>
<H3 tabindex="0">      Interaction: Authentication Request</H3><IMG tabindex="0" 
alt="Authentication Request interaction screenshot&#10;      " src="">
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t1"><SPAN>1. Spoofing the Third Party 
Application External Entity</SPAN>&nbsp;        [State: Not Started]&nbsp;       
 [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Third Party Application may be spoofed by an attacker and this may lead to unauthorized access to Keycloak. Consider using a standard authentication mechanism to identify the external entity.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use multi-factor authentication</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t2"><SPAN>2. Elevation Using 
Impersonation</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak may be able to impersonate the context of Third Party Application in order to gain additional privilege.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize principle of least privilege</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t3"><SPAN>3. Cross Site Request 
Forgery</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Cross-site request forgery (CSRF or XSRF) is a type of attack in which an attacker forces a user's browser to make a forged request to a vulnerable site by exploiting an existing trust relationship between the browser and the vulnerable web site.  In a simple scenario, a user is logged in to web site A using a cookie as a credential.  The other browses to web site B.  Web site B returns a page with a hidden form that posts to web site A.  Since the browser will carry the user's cookie to web site A, web site B now can take any action on web site A, for example, adding an admin to an account.  The attack can be used to exploit any requests that the browser automatically authenticates, e.g. by session cookie, integrated authentication, IP whitelisting, …  The attack can be carried out in many ways such as by luring the victim to a site under control of the attacker, getting the user to click a link in a phishing email, or hacking a reputable web site that the victim will visit. The issue can only be resolved on the server side by requiring that all authenticated state-changing requests include an additional piece of secret payload (canary or CSRF token) which is known only to the legitimate web site and the browser and which is protected in transit through SSL/TLS. See the Forgery Protection property on the flow stencil for a list of mitigations.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Require a state cookie be used and matched against a transmitted state parameter</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t4"><SPAN>4. Elevation by Changing the 
Execution Flow in Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An attacker may pass data into Keycloak in order to change the flow of program execution within Keycloak to the attacker's choosing.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Ulitize input validation and implement ACLs</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t5"><SPAN>5. Keycloak May be Subject to 
Elevation of Privilege Using Remote Code Execution</SPAN>&nbsp;        [State: 
Not Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Third Party Application may be able to remotely execute code for Keycloak.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Vallidate all input</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t6"><SPAN>6. Data Flow Authentication 
Request Is Potentially Interrupted</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent interrupts data flowing across a trust boundary in either direction.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Ability to continue processing in reduced capacity</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t7"><SPAN>7. Potential Process Crash or Stop 
for Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak crashes, halts, stops or runs slowly; in all cases violating an availability metric.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Validate all input and ability to continue processing in a reduced capacity.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t8"><SPAN>8. Data Flow Sniffing</SPAN>&nbsp; 
       [State: Not Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Information Disclosure</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Data flowing across Authentication Request may be sniffed by an attacker. Depending on what type of data an attacker can read, it may be used to attack other parts of the system or simply be a disclosure of information leading to compliance violations. Consider encrypting the data flow.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use encryption with authentication</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t9"><SPAN>9. Potential Data Repudiation by 
Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Repudiation</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak claims that it did not receive data from a source outside the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Logging and auditing of recieved data.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t10"><SPAN>10. Potential Lack of Input 
Validation for Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Tampering</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Data flowing across Authentication Request may be tampered with by an attacker. This may lead to a denial of service attack against Keycloak or an elevation of privilege attack against Keycloak or an information disclosure by Keycloak. Failure to verify that input is as expected is a root cause of a very large number of exploitable issues. Consider all paths and the way they handle data. Verify that all input is verified for correctness using an approved list input validation approach.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Normalization before sanitization </TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t11"><SPAN>11. Spoofing the Keycloak 
Process</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak may be spoofed by an attacker and this may lead to information disclosure by Third Party Application. Consider using a standard authentication mechanism to identify the destination process.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use multi-factor authentication</TD></TR></TBODY></TABLE></DIV><BR>
<H3 tabindex="0">      Interaction: Authentication Request</H3><IMG tabindex="0" 
alt="Authentication Request interaction screenshot&#10;      " src="">
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t12"><SPAN>12. Spoofing the End User 
External Entity</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">End User may be spoofed by an attacker and this may lead to unauthorized access to Keycloak. Consider using a standard authentication mechanism to identify the external entity.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize multi-factor authentication</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t13"><SPAN>13. Elevation Using 
Impersonation</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak may be able to impersonate the context of End User in order to gain additional privilege.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize principle of least privilege</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t14"><SPAN>14. Cross Site Request 
Forgery</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Cross-site request forgery (CSRF or XSRF) is a type of attack in which an attacker forces a user's browser to make a forged request to a vulnerable site by exploiting an existing trust relationship between the browser and the vulnerable web site.  In a simple scenario, a user is logged in to web site A using a cookie as a credential.  The other browses to web site B.  Web site B returns a page with a hidden form that posts to web site A.  Since the browser will carry the user's cookie to web site A, web site B now can take any action on web site A, for example, adding an admin to an account.  The attack can be used to exploit any requests that the browser automatically authenticates, e.g. by session cookie, integrated authentication, IP whitelisting, …  The attack can be carried out in many ways such as by luring the victim to a site under control of the attacker, getting the user to click a link in a phishing email, or hacking a reputable web site that the victim will visit. The issue can only be resolved on the server side by requiring that all authenticated state-changing requests include an additional piece of secret payload (canary or CSRF token) which is known only to the legitimate web site and the browser and which is protected in transit through SSL/TLS. See the Forgery Protection property on the flow stencil for a list of mitigations.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Require a state cookie be used and matched against a transmitted state parameter</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t15"><SPAN>15. Elevation by Changing the 
Execution Flow in Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An attacker may pass data into Keycloak in order to change the flow of program execution within Keycloak to the attacker's choosing.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize ACLs and validate all input</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t16"><SPAN>16. Keycloak May be Subject to 
Elevation of Privilege Using Remote Code Execution</SPAN>&nbsp;        [State: 
Not Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">End User may be able to remotely execute code for Keycloak.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Vallidate all input</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t17"><SPAN>17. Data Flow Authentication 
Request Is Potentially Interrupted</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent interrupts data flowing across a trust boundary in either direction.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Ability to continue processing in reduced capacity</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t18"><SPAN>18. Potential Process Crash or 
Stop for Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak crashes, halts, stops or runs slowly; in all cases violating an availability metric.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Validate all input and ability to continue processing in a reduced capacity.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t19"><SPAN>19. Data Flow 
Sniffing</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Information Disclosure</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Data flowing across Authentication Request may be sniffed by an attacker. Depending on what type of data an attacker can read, it may be used to attack other parts of the system or simply be a disclosure of information leading to compliance violations. Consider encrypting the data flow.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use strong encryption algorithm</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t20"><SPAN>20. Potential Data Repudiation by 
Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Repudiation</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak claims that it did not receive data from a source outside the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Logging and auditing of recieved data.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t21"><SPAN>21. Potential Lack of Input 
Validation for Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Tampering</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Data flowing across Authentication Request may be tampered with by an attacker. This may lead to a denial of service attack against Keycloak or an elevation of privilege attack against Keycloak or an information disclosure by Keycloak. Failure to verify that input is as expected is a root cause of a very large number of exploitable issues. Consider all paths and the way they handle data. Verify that all input is verified for correctness using an approved list input validation approach.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Validate all input</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t22"><SPAN>22. Spoofing the Keycloak 
Process</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak may be spoofed by an attacker and this may lead to information disclosure by End User. Consider using a standard authentication mechanism to identify the destination process.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize multi-factor authentication</TD></TR></TBODY></TABLE></DIV><BR>
<H3 tabindex="0">      Interaction: Authentication Request</H3><IMG tabindex="0" 
alt="Authentication Request interaction screenshot&#10;      " src="">
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t23"><SPAN>23. Data Flow Authentication 
Request Is Potentially Interrupted</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent interrupts data flowing across a trust boundary in either direction.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Implement ACLs to protect objects from deletion or modification </TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t24"><SPAN>24. External Entity LDAP/Active 
Directory Potentially Denies Receiving Data</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Repudiation</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">LDAP/Active Directory claims that it did not receive data from a process on the other side of the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">LDAP logging and auditing.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t25"><SPAN>25. Spoofing of the LDAP/Active 
Directory External Destination Entity</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">LDAP/Active Directory may be spoofed by an attacker and this may lead to data being sent to the attacker's target instead of LDAP/Active Directory. Consider using a standard authentication mechanism to identify the external entity.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use authentication based key exchange</TD></TR></TBODY></TABLE></DIV><BR>
<H3 tabindex="0">      Interaction: Authentication Response</H3><IMG tabindex="0" 
alt="Authentication Response interaction screenshot&#10;      " src="">
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t26"><SPAN>26. Spoofing the LDAP/Active 
Directory External Entity</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">LDAP/Active Directory may be spoofed by an attacker and this may lead to unauthorized access to Keycloak. Consider using a standard authentication mechanism to identify the external entity.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use authentication based key exchange</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t27"><SPAN>27. Elevation Using 
Impersonation</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak may be able to impersonate the context of LDAP/Active Directory in order to gain additional privilege.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize principle of least privilege</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t28"><SPAN>28. Cross Site Request 
Forgery</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Cross-site request forgery (CSRF or XSRF) is a type of attack in which an attacker forces a user's browser to make a forged request to a vulnerable site by exploiting an existing trust relationship between the browser and the vulnerable web site.  In a simple scenario, a user is logged in to web site A using a cookie as a credential.  The other browses to web site B.  Web site B returns a page with a hidden form that posts to web site A.  Since the browser will carry the user's cookie to web site A, web site B now can take any action on web site A, for example, adding an admin to an account.  The attack can be used to exploit any requests that the browser automatically authenticates, e.g. by session cookie, integrated authentication, IP whitelisting, …  The attack can be carried out in many ways such as by luring the victim to a site under control of the attacker, getting the user to click a link in a phishing email, or hacking a reputable web site that the victim will visit. The issue can only be resolved on the server side by requiring that all authenticated state-changing requests include an additional piece of secret payload (canary or CSRF token) which is known only to the legitimate web site and the browser and which is protected in transit through SSL/TLS. See the Forgery Protection property on the flow stencil for a list of mitigations.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Escape all variables using the right ldap encoding function</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t29"><SPAN>29. Elevation by Changing the 
Execution Flow in Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An attacker may pass data into Keycloak in order to change the flow of program execution within Keycloak to the attacker's choosing.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Implement ACLs, Input Validation, and setup AD security groups and roles</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t30"><SPAN>30. Keycloak May be Subject to 
Elevation of Privilege Using Remote Code Execution</SPAN>&nbsp;        [State: 
Not Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">LDAP/Active Directory may be able to remotely execute code for Keycloak.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Vallidate all input and use security groups and roles</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t31"><SPAN>31. Data Flow Authentication 
Response Is Potentially Interrupted</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent interrupts data flowing across a trust boundary in either direction.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Implement ACLs to protect objects from deletion or modification </TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t32"><SPAN>32. Potential Process Crash or 
Stop for Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak crashes, halts, stops or runs slowly; in all cases violating an availability metric.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Not Applicable (inaccessibility threat does not apply to this process)</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t33"><SPAN>33. Data Flow 
Sniffing</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Information Disclosure</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Data flowing across Authentication Response may be sniffed by an attacker. Depending on what type of data an attacker can read, it may be used to attack other parts of the system or simply be a disclosure of information leading to compliance violations. Consider encrypting the data flow.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use ACLs and encryption protocols </TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t34"><SPAN>34. Potential Data Repudiation by 
Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Repudiation</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak claims that it did not receive data from a source outside the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">LDAP logging and auditing</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t35"><SPAN>35. Potential Lack of Input 
Validation for Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Tampering</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Data flowing across Authentication Response may be tampered with by an attacker. This may lead to a denial of service attack against Keycloak or an elevation of privilege attack against Keycloak or an information disclosure by Keycloak. Failure to verify that input is as expected is a root cause of a very large number of exploitable issues. Consider all paths and the way they handle data. Verify that all input is verified for correctness using an approved list input validation approach.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Implement ACLs</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t36"><SPAN>36. Spoofing the Keycloak 
Process</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak may be spoofed by an attacker and this may lead to information disclosure by LDAP/Active Directory. Consider using a standard authentication mechanism to identify the destination process.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use authentication based key exchange</TD></TR></TBODY></TABLE></DIV><BR>
<H3 tabindex="0">      Interaction: Authentication Response</H3><IMG tabindex="0" 
alt="Authentication Response interaction screenshot&#10;      " src="">
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t37"><SPAN>37. Data Flow Authentication 
Response Is Potentially Interrupted</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent interrupts data flowing across a trust boundary in either direction.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Do not block waiting for responses that cross the trust boundary</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t38"><SPAN>38. External Entity End User 
Potentially Denies Receiving Data</SPAN>&nbsp;        [State: Not Started]&nbsp; 
       [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Repudiation</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">End User claims that it did not receive data from a process on the other side of the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Logging and auditing of received data.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t39"><SPAN>39. Spoofing of the End User 
External Destination Entity</SPAN>&nbsp;        [State: Not Started]&nbsp;       
 [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">End User may be spoofed by an attacker and this may lead to data being sent to the attacker's target instead of End User. Consider using a standard authentication mechanism to identify the external entity.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize multi-factor authentication</TD></TR></TBODY></TABLE></DIV><BR>
<H3 tabindex="0">      Interaction: Authentication Response</H3><IMG tabindex="0" 
alt="Authentication Response interaction screenshot&#10;      " src="">
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t40"><SPAN>40. Data Flow Authentication 
Response Is Potentially Interrupted</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent interrupts data flowing across a trust boundary in either direction.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Do not block waiting for responses that cross the trust boundary</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t41"><SPAN>41. External Entity Third Party 
Application Potentially Denies Receiving Data</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Repudiation</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Third Party Application claims that it did not receive data from a process on the other side of the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Logging and auditing of received data.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t42"><SPAN>42. Spoofing of the Third Party 
Application External Destination Entity</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Third Party Application may be spoofed by an attacker and this may lead to data being sent to the attacker's target instead of Third Party Application. Consider using a standard authentication mechanism to identify the external entity.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize multi-factor authentication</TD></TR></TBODY></TABLE></DIV><BR>
<H3 tabindex="0">      Interaction: Client Registration</H3><IMG tabindex="0" 
alt="Client Registration interaction screenshot&#10;      " src="">
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t43"><SPAN>43. Elevation Using 
Impersonation</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak may be able to impersonate the context of Client Adapters in order to gain additional privilege.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize principle of least privilege</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t44"><SPAN>44. Spoofing the Client Adapters 
External Entity</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Client Adapters may be spoofed by an attacker and this may lead to unauthorized access to Keycloak. Consider using a standard authentication mechanism to identify the external entity.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize multi-factor authentication</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t45"><SPAN>45. Spoofing the Keycloak 
Process</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak may be spoofed by an attacker and this may lead to information disclosure by Client Adapters. Consider using a standard authentication mechanism to identify the destination process.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use multi-factor authentication</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t46"><SPAN>46. Potential Lack of Input 
Validation for Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Tampering</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Data flowing across Client Registration may be tampered with by an attacker. This may lead to a denial of service attack against Keycloak or an elevation of privilege attack against Keycloak or an information disclosure by Keycloak. Failure to verify that input is as expected is a root cause of a very large number of exploitable issues. Consider all paths and the way they handle data. Verify that all input is verified for correctness using an approved list input validation approach.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Normalization before sanitization</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t47"><SPAN>47. Potential Data Repudiation by 
Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Repudiation</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak claims that it did not receive data from a source outside the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Logging and auditing of recieved data.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t48"><SPAN>48. Data Flow 
Sniffing</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Information Disclosure</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Data flowing across Client Registration may be sniffed by an attacker. Depending on what type of data an attacker can read, it may be used to attack other parts of the system or simply be a disclosure of information leading to compliance violations. Consider encrypting the data flow.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use encryption with authentication </TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t49"><SPAN>49. Potential Process Crash or 
Stop for Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak crashes, halts, stops or runs slowly; in all cases violating an availability metric.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Validate all input and ability to continue processing in a reduced capacity.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t50"><SPAN>50. Data Flow Client Registration 
Is Potentially Interrupted</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent interrupts data flowing across a trust boundary in either direction.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Ability to continue processing in reduced capacity</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t51"><SPAN>51. Keycloak May be Subject to 
Elevation of Privilege Using Remote Code Execution</SPAN>&nbsp;        [State: 
Not Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Client Adapters may be able to remotely execute code for Keycloak.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Vallidate all input</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t52"><SPAN>52. Elevation by Changing the 
Execution Flow in Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An attacker may pass data into Keycloak in order to change the flow of program execution within Keycloak to the attacker's choosing.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Implemented ACLs and Input Validation</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t53"><SPAN>53. Cross Site Request 
Forgery</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Cross-site request forgery (CSRF or XSRF) is a type of attack in which an attacker forces a user's browser to make a forged request to a vulnerable site by exploiting an existing trust relationship between the browser and the vulnerable web site.  In a simple scenario, a user is logged in to web site A using a cookie as a credential.  The other browses to web site B.  Web site B returns a page with a hidden form that posts to web site A.  Since the browser will carry the user's cookie to web site A, web site B now can take any action on web site A, for example, adding an admin to an account.  The attack can be used to exploit any requests that the browser automatically authenticates, e.g. by session cookie, integrated authentication, IP whitelisting, …  The attack can be carried out in many ways such as by luring the victim to a site under control of the attacker, getting the user to click a link in a phishing email, or hacking a reputable web site that the victim will visit. The issue can only be resolved on the server side by requiring that all authenticated state-changing requests include an additional piece of secret payload (canary or CSRF token) which is known only to the legitimate web site and the browser and which is protected in transit through SSL/TLS. See the Forgery Protection property on the flow stencil for a list of mitigations.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Require a state cookie be used and matched against a transmitted state parameter</TD></TR></TBODY></TABLE></DIV><BR>
<H3 tabindex="0">      Interaction: JDBC Query</H3><IMG tabindex="0" alt="JDBC Query interaction screenshot&#10;      " 
src="">
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t54"><SPAN>54. Spoofing of Destination Data 
Store Database</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Database may be spoofed by an attacker and this may lead to data being written to the attacker's target instead of Database. Consider using a standard authentication mechanism to identify the destination data store.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use authentication based key exchange</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t55"><SPAN>55. Potential Excessive Resource 
Consumption for Keycloak or Database</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Does Keycloak or Database take explicit steps to control resource consumption? Resource consumption attacks can be hard to deal with, and there are times that it makes sense to let the OS do the job. Be careful that your resource requests don't deadlock, and that they do timeout.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Configuration management on the data store to set time out.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t56"><SPAN>56. Spoofing the Keycloak 
Process</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak may be spoofed by an attacker and this may lead to unauthorized access to Database. Consider using a standard authentication mechanism to identify the source process.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use authentication based key exchange</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t57"><SPAN>57. The Database Data Store Could 
Be Corrupted</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Tampering</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Data flowing across JDBC Query may be tampered with by an attacker. This may lead to corruption of Database. Ensure the integrity of the data flow to the data store.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Normalization before being set along with authentication</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t58"><SPAN>58. Data Store Denies Database 
Potentially Writing Data</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Repudiation</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Database claims that it did not write data received from an entity on the other side of the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Logging on both process side and data store side</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t59"><SPAN>59. Data Flow 
Sniffing</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Information Disclosure</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Data flowing across JDBC Query may be sniffed by an attacker. Depending on what type of data an attacker can read, it may be used to attack other parts of the system or simply be a disclosure of information leading to compliance violations. Consider encrypting the data flow.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use encryption with authentication</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t60"><SPAN>60. Data Flow JDBC Query Is 
Potentially Interrupted</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent interrupts data flowing across a trust boundary in either direction.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Handling all possible exceptions in a manner which prevents application down time.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t61"><SPAN>61. Data Store 
Inaccessible</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent prevents access to a data store on the other side of the trust boundary.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Not applicable (inaccessible threat does not apply to this data store)</TD></TR></TBODY></TABLE></DIV><BR>
<H3 tabindex="0">      Interaction: Result Set</H3><IMG tabindex="0" alt="Result Set interaction screenshot&#10;      " 
src="">
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t62"><SPAN>62. Spoofing of Source Data Store 
Database</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Database may be spoofed by an attacker and this may lead to incorrect data delivered to Keycloak. Consider using a standard authentication mechanism to identify the source data store.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use authentication based key exchange</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t63"><SPAN>63. Weak Access Control for a 
Resource</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Information Disclosure</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Improper data protection of Database can allow an attacker to read information not intended for disclosure. Review authorization settings.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use encryption with authentication</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t64"><SPAN>64. Spoofing the Keycloak 
Process</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak may be spoofed by an attacker and this may lead to information disclosure by Database. Consider using a standard authentication mechanism to identify the destination process.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Use authentication based key exchange</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t65"><SPAN>65. Potential Data Repudiation by 
Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Repudiation</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak claims that it did not receive data from a source outside the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Logging on both process side and data store side.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t66"><SPAN>66. Potential Process Crash or 
Stop for Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Keycloak crashes, halts, stops or runs slowly; in all cases violating an availability metric.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Not Applicable (inaccessibility threat does not apply to this process)</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t67"><SPAN>67. Data Flow Result Set Is 
Potentially Interrupted</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent interrupts data flowing across a trust boundary in either direction.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Handling all possible exceptions in a manner which prevents application down time.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t68"><SPAN>68. Data Store 
Inaccessible</SPAN>&nbsp;        [State: Not Started]&nbsp;        [Priority: 
High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent prevents access to a data store on the other side of the trust boundary.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Not applicable (inaccessible threat does not apply to this data store)</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t69"><SPAN>69. Keycloak May be Subject to 
Elevation of Privilege Using Remote Code Execution</SPAN>&nbsp;        [State: 
Not Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Database may be able to remotely execute code for Keycloak.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Implemented ACLs and Input Validation from the data store</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t70"><SPAN>70. Elevation by Changing the 
Execution Flow in Keycloak</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Elevation Of Privilege</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An attacker may pass data into Keycloak in order to change the flow of program execution within Keycloak to the attacker's choosing.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Implemented ACLs and Input Validation from the data store</TD></TR></TBODY></TABLE></DIV><BR>
<H3 tabindex="0">      Interaction: Token Registration</H3><IMG tabindex="0" 
alt="Token Registration interaction screenshot&#10;      " src="">
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t71"><SPAN>71. Spoofing of the Client 
Adapters External Destination Entity</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Spoofing</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Client Adapters may be spoofed by an attacker and this may lead to data being sent to the attacker's target instead of Client Adapters. Consider using a standard authentication mechanism to identify the external entity.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Utilize multi-factor authentication</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t72"><SPAN>72. External Entity Client 
Adapters Potentially Denies Receiving Data</SPAN>&nbsp;        [State: Not 
Started]&nbsp;        [Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Repudiation</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">Client Adapters claims that it did not receive data from a process on the other side of the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Logging and auditing of received data.</TD></TR></TBODY></TABLE></DIV>
<DIV class="threat">
<H4 tabindex="0" id="&#10;          t73"><SPAN>73. Data Flow Token Registration 
Is Potentially Interrupted</SPAN>&nbsp;        [State: Not Started]&nbsp;        
[Priority: High]&nbsp;         </H4>
<TABLE role="grid">
  <TBODY>
  <TR>
    <TD tabindex="0" id="threat-title-category" 
      role="rowheader"><STRONG>Category:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-category">Denial Of Service</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-description" 
      role="rowheader"><STRONG>Description:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-description">An external agent interrupts data flowing across a trust boundary in either direction.</TD></TR>
  <TR>
    <TD tabindex="0" id="threat-title-justification" 
      role="rowheader"><STRONG>Justification:</STRONG></TD>
<TD tabindex="0" class="infotd" role="gridcell" headers="threat-title-justification">Do not block waiting for responses that cross the trust boundary</TD></TR></TBODY></TABLE></DIV><BR></BODY></HTML>
